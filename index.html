<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Git支援システム</title>

<!--モジュールの宣言-->
<script src="first.js"></script>
<!--<link href="lib/bs/bootstrap.min.css" rel="stylesheet">
<script src="lib/ace/ace.js"></script>
<script src="lib/ace/mode-javascript.js"></script>
<script src="lib/ace/theme-twilight.js"></script>
<script src="editor.js"></script>
-->
<script>
/*右カラムの縦幅リサイズ（左カラムに依存）*/
  (function(){
    var leftside = document.querySelector("#f_list");
    var wid = leftside.style.height;
    document.getElementById("det_zone").style.height = wid;
  });
  window.onresize = function(){
    var leftside = document.querySelector("#f_list");
    var wid = leftside.style.height;
    document.getElementById("det_zone").style.height = wid;
  }


    //前のコミット段階のデータとの差分比較
    function Diff(){
      exec('git diff' , function (error, stdout, stderr) {
              if(error == null){
                var re = /[@][@].[-](.*?),(.*?)\+(.*?),(.*?)[@][@]/g;
                var match = stdout.match(re);
                var re2 = /[@][@].[-](.*?),(.*?)\+(.*?),(.*?)[@][@]/;
                var i = 0;
                var match2 = new Array();
                while(i<match.length){
                match2[i] = match[i].match(re2);
                i++;
              }
              var DiffInfo = match.length + "箇所に変更がある。\n";
              var j =0;
              while(j<match.length){
                DiffInfo +=j+1 +"箇所目は"+ match2[j][1] + "行目から" + match2[j][2] + "行分にかけて変更があり、";
                if(match2[j][4]-match2[j][2] < 0){
                  DiffInfo += Math.abs(match2[j][4]-match2[j][2]) + "行減少しました。\n";
                }else if (match2[j][4]-match2[j][2] > 0) {
                  DiffInfo += Math.abs(match2[j][4]-match2[j][2]) + "行増加しました。\n";
                }else{
                  DiffInfo += "行数に変化はありません。\n";
                }
                j++;
              }
                  document.getElementById('title').innerHTML = "<b>＜差分＞</b><br>"
                  document.getElementById('edit_zone').innerText = DiffInfo;
                  document.getElementById('footer').innerHTML = "Load Success.";
              }
          });
    }
</script>

<!--<webview id="githubSighUp" src="https://github.com/join" autosize="on"></webview>-->

<link rel="stylesheet" type="text/css" href="index.css" />
</head>
<body>
<div id="pagebody">

  <!-- ヘッダ -->
<div id="header"><h1><a href="index.html">Git支援システム</a></h1></div>

	<!-- メインメニュー -->
	<ul id="menu">
		<li id="menu01"><a href="javascript:void(0)" onClick="Add()" title="以前の変更からさらに変更があったファイルの差分を保存します">差分を保存</a></li>
		<li id="menu02"><a href="javascript:void(0)" onClick="Diff()" title="現状と1つ前のコミット状態の差を表示する">差分を表示</a></li>
		<li id="menu03"><a href="javascript:void(0)" onClick="Push()">サーバにアップ</a></li>
		<li id="menu04"><a href="javascript:void(0)" onClick="Pull()">更新情報を同期</a></li>
		<li id="menu05"><a href="javascript:void(0)" onClick="Reset()">最新のｺﾐｯﾄ状態に戻す</a></li>
	</ul>

	<!-- 左カラム(f_list) -->
<div id="f_list">
    <script src="app.js"></script>
<div id="res0">ver...</div>
<div id="chk_name"></div>
<div id="chk_address"></div>
<div id="chk_hub">
  <script>
  //GitHubアカウント登録画面
  function SignUpGH(){
    document.getElementById('det_zone').innerHTML = "<webview id='githubSighUp' src='https://github.com/join' style='height:57%;'></webview><br><form name='repo'><input type='text' name='Reposit' value=''> <input type='button' value='登録' onClick='SetRepo()'><br></form>";
  }
  </script>
GitHub未登録の場合,<font color='#ff0000'><a href='javascript:SignUpGH()'>ココ</a></font>から登録しよう！<br>
</div>
    <p>今閲覧中のカレントディレクトリ</p>
<div id="res1">ここに今のディレクトリパスを表示</div>
<div id="Init_Info">ここにInit情報を表示</div>
<br>
<div id="res2">指定ディレクトリ内のファイル・サブフォルダ表示</div>
</div>

  <!--　右カラム(det_zone) -->
<div id="title"></div>
<div id="det_zone">
<div id="header_fixed">
  <button type='button' onClick='saveFile()'>保存</button>　<button type='button' onClick='TmpCommit()'>一時コミット</button>
</div>
<div id='footer_fixed'></div>
<div id='input_area'>
  <textarea id="edit_zone" cols="50" rows="20"></textarea>
</div>
<div id="commit"><b>＜差分保存の際の変更点記入欄＞</b><br>差分の保存メニューを押す前にココへ以前からの変更点を大まかに記入してください<br>例）○○○を実装, xxxのバグを修正 etc<br>
  <textarea id="c_det" cols="40" rows="3"></textarea>
</div>
</div>

<!-- フッタ -->
<div id="footer">
---
</div>

</div>
</body>
</html>
